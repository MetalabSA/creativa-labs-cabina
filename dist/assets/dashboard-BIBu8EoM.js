import{c as h,b as i,s as m,j as e,D as W,n as q,Z as ee,P as J,X as Q,f as te,L as se,Q as ae,e as Z,A as re,S as V,I as R,d as le,p as ce,R as ie}from"./constants-0WJSyr-7.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],oe=h("activity",ne);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]],O=h("bolt",de);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],M=h("calendar",xe);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],$=h("circle-check",he);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],me=h("external-link",pe);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],be=h("globe",ue);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],fe=h("image",ge);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],ve=h("layout-dashboard",je);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M5 12h14",key:"1ays0h"}]],we=h("minus",Ne);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],B=h("palette",ye);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],_e=h("pen",ke);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],K=h("plus",Ce);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ee=h("save",Se);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],G=h("shopping-cart",ze);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],X=h("trash-2",Me);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Pe=h("upload",Ae);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],$e=h("user-plus",Le);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ue=h("users",De);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],H=h("wallet",Re),I=({user:k,profile:j,onBack:r,initialView:v="overview"})=>{const[w,g]=i.useState(!0),[c,_]=i.useState(null),[d,N]=i.useState([]),[x,p]=i.useState(""),[u,b]=i.useState(!1),[n,s]=i.useState({primary_color:"#135bec",logo_url:"",radius:"12px",style_presets:["Superhéroes","John Wick","Urbano"]}),[o,y]=i.useState({name:"",slug:"",credits:500,start_date:new Date().toISOString().split("T")[0],end_date:new Date(Date.now()+10080*60*1e3).toISOString().split("T")[0]});i.useEffect(()=>{z()},[j.partner_id]);const z=async()=>{try{if(g(!0),!j.partner_id){g(!1);return}const[t,l]=await Promise.all([m.from("partners").select("*").eq("id",j.partner_id).single(),m.from("events").select("*").eq("partner_id",j.partner_id).order("created_at",{ascending:!1})]);if(t.error)throw t.error;_(t.data),t.data.config&&s({primary_color:t.data.config.primary_color||"#135bec",logo_url:t.data.config.logo_url||"",radius:t.data.config.radius||"12px",style_presets:t.data.config.style_presets||["Superhéroes","John Wick","Urbano"]}),N(l.data||[])}catch(t){console.error("Error fetching partner data:",t)}finally{g(!1)}},S=async()=>{if(c)try{const{error:t}=await m.from("partners").update({config:n}).eq("id",c.id);if(t)throw t;_({...c,config:n}),alert("Configuración de marca guardada")}catch(t){console.error("Error updating branding:",t)}},A=async t=>{if(t.preventDefault(),!c)return;const l=Number(o.credits);if(l>c.credits_total-c.credits_used){alert("Créditos insuficientes en tu balance mayorista.");return}try{g(!0);const{data:f,error:C}=await m.from("events").insert([{partner_id:c.id,event_name:o.name,event_slug:o.slug||o.name.toLowerCase().replace(/\s+/g,"-"),credits_allocated:l,credits_used:0,start_date:new Date(o.start_date).toISOString(),end_date:new Date(o.end_date).toISOString(),is_active:!0,selected_styles:n.style_presets}]).select();if(C)throw C;const{error:E}=await m.from("partners").update({credits_used:c.credits_used+l}).eq("id",c.id);if(E)throw E;b(!1),y({name:"",slug:"",credits:500,start_date:"",end_date:""}),z()}catch(f){console.error("Error creating event:",f),alert("Error al crear el evento. El slug podría estar duplicado.")}finally{g(!1)}},D=async t=>{if(confirm("¿Estás seguro de eliminar este evento?"))try{const{error:l}=await m.from("events").delete().eq("id",t);if(l)throw l;z()}catch(l){console.error("Error deleting event:",l)}},U=t=>{const l=n.style_presets.includes(t)?n.style_presets.filter(f=>f!==t):[...n.style_presets,t];s({...n,style_presets:l})},P=i.useMemo(()=>d.filter(t=>t.event_name.toLowerCase().includes(x.toLowerCase())||t.event_slug.toLowerCase().includes(x.toLowerCase())),[d,x]);if(w&&!c)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] text-white space-y-4",children:[e.jsx("div",{className:"size-12 border-4 border-[#135bec] border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"font-bold tracking-widest text-[10px] uppercase opacity-50",children:"Sincronizando con la red..."})]});const L=((c==null?void 0:c.credits_total)||0)-((c==null?void 0:c.credits_used)||0),a=c!=null&&c.credits_total?Math.round(c.credits_used/c.credits_total*100):0;return e.jsxs("div",{className:"space-y-8 animate-fade-in text-slate-100",children:[e.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black tracking-tight text-white mb-1",children:"Partner Dashboard"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Gestiona tus eventos, créditos y personalización de marca."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{className:"flex items-center gap-2 px-5 py-2.5 bg-slate-800 hover:bg-slate-700 border border-slate-700 rounded-lg text-sm font-semibold text-white transition-all",children:[e.jsx(W,{className:"w-5 h-5 transition-transform group-hover:translate-y-0.5"}),"Reportes"]}),e.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-6 py-2.5 bg-[#135bec] hover:bg-[#135bec]/90 rounded-lg text-sm font-bold text-white shadow-lg shadow-[#135bec]/25 transition-all group",children:[e.jsx(K,{className:"w-5 h-5 group-hover:rotate-90 transition-transform"}),"Crear Nuevo Evento"]})]})]}),e.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"glass-card rounded-xl p-6 flex flex-col justify-between group overflow-hidden relative",children:[e.jsx("div",{className:"absolute -right-4 -top-4 opacity-[0.03] group-hover:opacity-[0.07] transition-opacity",children:e.jsx(H,{className:"size-32"})}),e.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Créditos Disponibles"}),e.jsx("h3",{className:"text-3xl font-black text-white",children:L.toLocaleString()})]}),e.jsx("div",{className:"p-2 bg-[#135bec]/20 rounded-lg text-[#135bec]",children:e.jsx(H,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-2 relative z-10",children:[e.jsxs("div",{className:"flex justify-between text-[11px] font-bold",children:[e.jsx("span",{className:"text-slate-500 uppercase tracking-widest",children:"CONSUMO"}),e.jsxs("span",{className:"text-[#135bec]",children:[a,"% USADO"]})]}),e.jsx("div",{className:"w-full bg-slate-800 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-[#135bec] h-full rounded-full shadow-[0_0_8px_rgba(19,91,236,0.5)] transition-all duration-1000",style:{width:`${a}%`}})}),e.jsxs("p",{className:"text-[10px] text-slate-500 italic text-right",children:[c==null?void 0:c.credits_used," usados de ",c==null?void 0:c.credits_total]})]})]}),e.jsxs("div",{className:"glass-card rounded-xl p-6 flex flex-col justify-between group overflow-hidden relative",children:[e.jsx("div",{className:"absolute -right-4 -top-4 opacity-[0.03] group-hover:opacity-[0.07] transition-opacity",children:e.jsx(M,{className:"size-32"})}),e.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Eventos Activos"}),e.jsx("h3",{className:"text-3xl font-black text-white",children:d.filter(t=>t.is_active).length})]}),e.jsx("div",{className:"p-2 bg-emerald-500/20 rounded-lg text-emerald-500",children:e.jsx(O,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex items-center gap-2 relative z-10",children:[e.jsxs("div",{className:"flex -space-x-2",children:[d.slice(0,3).map((t,l)=>e.jsx("div",{className:"w-7 h-7 rounded-full border-2 border-slate-900 bg-[#135bec] flex items-center justify-center text-[8px] font-black",children:t.event_name.substring(0,1).toUpperCase()},l)),d.length>3&&e.jsxs("div",{className:"w-7 h-7 rounded-full border-2 border-slate-900 bg-slate-700 flex items-center justify-center text-[8px] font-black",children:["+",d.length-3]})]}),e.jsx("span",{className:"text-xs text-slate-400 font-medium",children:"Eventos en curso"})]})]}),e.jsxs("div",{className:"glass-card rounded-xl p-6 flex flex-col justify-between border-[#135bec]/30 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10 group-hover:scale-110 transition-transform",children:e.jsx(G,{className:"w-24 h-24 text-[#135bec]"})}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Cargar Créditos"}),e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 leading-tight",children:["¿Te quedas sin créditos?",e.jsx("br",{}),"Recarga al instante."]}),e.jsx("button",{onClick:()=>alert("Para recargar créditos, por favor contacta a tu ejecutivo de cuenta o solicita una recarga desde el canal de soporte."),className:"px-4 py-2 bg-white text-slate-900 rounded-lg text-xs font-black uppercase tracking-wide hover:bg-[#135bec] hover:text-white transition-all shadow-xl shadow-white/5",children:"Recargar Pack"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tighter",children:"Listado de Eventos"}),e.jsxs("div",{className:"relative group",children:[e.jsx(q,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 group-focus-within:text-[#135bec] transition-colors"}),e.jsx("input",{type:"text",placeholder:"Buscar evento...",value:x,onChange:t=>p(t.target.value),className:"bg-slate-900/50 border border-slate-800 rounded-lg pl-9 pr-4 py-2 text-xs text-white focus:ring-[#135bec] focus:border-[#135bec] w-56 transition-all outline-none"})]})]}),e.jsx("div",{className:"glass-card rounded-xl overflow-hidden border border-white/5",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-white/[0.02] border-b border-white/5",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-xs font-black text-slate-500 uppercase tracking-widest",children:"Nombre del Evento"}),e.jsx("th",{className:"px-6 py-4 text-xs font-black text-slate-500 uppercase tracking-widest",children:"Consumo"}),e.jsx("th",{className:"px-6 py-4 text-xs font-black text-slate-500 uppercase tracking-widest",children:"Estado"}),e.jsx("th",{className:"px-6 py-4 text-xs font-black text-slate-500 uppercase tracking-widest text-right",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-white/5",children:[P.map(t=>{const l=t.credits_allocated?Math.min(100,Math.round(t.credits_used/t.credits_allocated*100)):0;return e.jsxs("tr",{className:"hover:bg-white/[0.02] transition-colors group",children:[e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"size-10 rounded-lg bg-[#135bec]/10 border border-[#135bec]/20 flex items-center justify-center text-[#135bec] font-black text-xs",children:t.event_name.substring(0,2).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white group-hover:text-[#135bec] transition-colors",children:t.event_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx(be,{className:"size-3 text-slate-600"}),e.jsxs("p",{className:"text-[10px] text-slate-500 font-mono",children:["/",t.event_slug]})]})]})]})}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"w-32",children:[e.jsxs("div",{className:"flex justify-between text-[10px] mb-1 font-bold",children:[e.jsxs("span",{className:"text-slate-400",children:[t.credits_used," / ",t.credits_allocated]}),e.jsxs("span",{className:`${l>90?"text-rose-500":"text-emerald-500"}`,children:[l,"%"]})]}),e.jsx("div",{className:"w-full h-1.5 bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${l>90?"bg-rose-500":"bg-[#135bec]"} rounded-full transition-all duration-700`,style:{width:`${l}%`}})})]})}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[10px] font-black uppercase tracking-wider ${t.is_active?"bg-emerald-500/10 text-emerald-500":"bg-rose-500/10 text-rose-500"}`,children:[e.jsx("span",{className:`size-1.5 rounded-full ${t.is_active?"bg-emerald-500 animate-pulse":"bg-rose-500"}`}),t.is_active?"Activo":"Pausado"]})}),e.jsx("td",{className:"px-6 py-5 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>window.open(`https://photobooth.creativa-labs.com/?event=${t.event_slug}`,"_blank"),className:"p-2 hover:bg-slate-800 rounded-lg text-slate-500 hover:text-white transition-all outline-none",title:"Ver Evento",children:e.jsx(ExternalLink,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>D(t.id),className:"p-2 hover:bg-rose-500/10 rounded-lg text-slate-500 hover:text-rose-500 transition-all outline-none",children:e.jsx(X,{className:"w-4 h-4"})}),e.jsx("button",{className:"px-4 py-1.5 bg-slate-800 hover:bg-slate-700 text-[10px] font-black rounded-lg text-white transition-all uppercase tracking-widest border border-white/5",children:"Gestionar"})]})})]},t.id)}),P.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:4,className:"p-12 text-center",children:[e.jsx(M,{className:"size-12 text-slate-800 mx-auto mb-3 opacity-20"}),e.jsx("p",{className:"text-slate-500 text-sm font-medium",children:"No se encontraron eventos."})]})})]})]})})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"glass-card rounded-xl p-6 border border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(B,{className:"size-5 text-[#135bec]"}),e.jsx("h2",{className:"text-lg font-black text-white uppercase tracking-tight",children:"Marca Blanca"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[2px] block mb-3",children:"Logo del Revendedor"}),e.jsxs("div",{className:"w-full border-2 border-dashed border-slate-800 rounded-xl p-6 flex flex-col items-center justify-center bg-slate-900/40 hover:bg-slate-900 transition-all cursor-pointer group hover:border-[#135bec]/50",children:[n.logo_url?e.jsx("img",{src:n.logo_url,className:"h-12 object-contain mb-2",alt:"Logo"}):e.jsx(Pe,{className:"w-8 h-8 text-slate-600 group-hover:text-[#135bec] mb-2 transition-colors"}),e.jsx("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-widest",children:"Subir Identidad"}),e.jsx("p",{className:"text-[9px] text-slate-600 mt-1 font-mono",children:"PNG / SVG recomendado"})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[2px] block mb-3",children:"Color de Acento"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"size-10 rounded-lg bg-[#135bec] border-2 border-white/10 shadow-xl cursor-pointer hover:scale-110 transition-transform",style:{backgroundColor:n.primary_color},onClick:()=>{var t;return(t=document.getElementById("colorPickerInput"))==null?void 0:t.click()}}),e.jsx("input",{id:"colorPickerInput",type:"color",className:"sr-only",value:n.primary_color,onChange:t=>s({...n,primary_color:t.target.value})}),e.jsx("input",{className:"flex-1 bg-slate-900 border border-slate-800 rounded-lg py-2.5 px-4 text-xs text-white font-mono focus:ring-[#135bec] focus:border-[#135bec] outline-none transition-all",type:"text",value:n.primary_color,onChange:t=>s({...n,primary_color:t.target.value})})]})]}),e.jsxs("div",{className:"w-20",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[2px] block mb-3",children:"Radius"}),e.jsxs("select",{className:"w-full bg-slate-900 border border-slate-800 rounded-lg py-2.5 px-2 text-xs text-white focus:ring-[#135bec] outline-none",value:n.radius,onChange:t=>s({...n,radius:t.target.value}),children:[e.jsx("option",{value:"4px",children:"4px"}),e.jsx("option",{value:"8px",children:"8px"}),e.jsx("option",{value:"12px",children:"12px"}),e.jsx("option",{value:"20px",children:"20px"})]})]})]}),e.jsx("button",{onClick:S,className:"w-full py-3.5 bg-slate-100 hover:bg-white text-slate-900 text-[10px] font-black rounded-xl transition-all shadow-xl shadow-white/5 uppercase tracking-[2px]",children:"Guardar Cambios"})]})]}),e.jsxs("div",{className:"glass-card rounded-xl p-6 border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"size-5 text-[#135bec]"}),e.jsx("h2",{className:"text-lg font-black text-white uppercase tracking-tight",children:"Pack de Diseños"})]}),e.jsxs("span",{className:"text-[10px] font-black px-2 py-1 bg-[#135bec]/10 text-[#135bec] rounded-md border border-[#135bec]/20",children:[n.style_presets.length," ACTIVOS"]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:J.map(t=>e.jsxs("label",{className:"relative block cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:n.style_presets.includes(t),onChange:()=>U(t),className:"peer sr-only"}),e.jsxs("div",{className:`h-24 rounded-xl overflow-hidden relative border-2 transition-all duration-300 ${n.style_presets.includes(t)?"border-[#135bec] scale-[1.02] shadow-lg shadow-[#135bec]/20":"border-white/5 opacity-40 hover:opacity-100"}`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent z-10"}),e.jsx("img",{alt:t,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700",src:`https://api.dicebear.com/7.x/identicon/svg?seed=${t}`}),e.jsx("span",{className:"absolute bottom-2.5 left-2.5 z-20 text-[9px] font-black uppercase text-white tracking-[1px] leading-tight",children:t}),e.jsx("div",{className:"absolute top-2 right-2 z-20 opacity-0 peer-checked:opacity-100 transition-all transform scale-50 peer-checked:scale-100",children:e.jsx("div",{className:"bg-[#135bec] rounded-full p-1 shadow-lg",children:e.jsx($,{className:"w-3 h-3 text-white"})})})]})]},t))}),e.jsxs("p",{className:"mt-6 text-[10px] text-slate-500 font-medium text-center leading-relaxed",children:[e.jsx(O,{className:"size-3 inline mr-1 text-[#135bec]"}),"Estos estilos estarán disponibles para tus clientes finales en sus eventos."]})]})]})]}),u&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-xl",children:e.jsxs("div",{className:"glass-card w-full max-w-lg bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between p-7 border-b border-white/5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tighter",children:"Crear Nuevo Evento"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 uppercase tracking-widest font-bold",children:"Configuración de instancia"})]}),e.jsx("button",{onClick:()=>b(!1),className:"size-10 flex items-center justify-center rounded-xl bg-slate-800 text-slate-500 hover:text-white transition-all",children:e.jsx(Q,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:A,className:"p-7 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-[2px] text-slate-500 mb-2 block",children:"Nombre del Evento"}),e.jsx("input",{required:!0,type:"text",placeholder:"Ej: Boda de Lucía y Marcos",className:"w-full bg-[#0a0a0b] border border-white/10 rounded-xl px-5 py-4 text-white focus:border-[#135bec] outline-none transition-all placeholder:text-slate-800",value:o.name,onChange:t=>y({...o,name:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-[2px] text-slate-500 mb-2 block",children:"Slug Personalizado"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-700 text-xs font-mono",children:"/"}),e.jsx("input",{type:"text",placeholder:"boda-lucia",className:"w-full bg-[#0a0a0b] border border-white/10 rounded-xl pl-8 pr-5 py-4 text-white focus:border-[#135bec] outline-none transition-all placeholder:text-slate-800 font-mono text-xs",value:o.slug,onChange:t=>y({...o,slug:t.target.value.toLowerCase().replace(/\s+/g,"-")})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-[2px] text-slate-500 mb-2 block",children:"Carga de Créditos"}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-[#135bec] size-4"}),e.jsx("input",{required:!0,type:"number",className:"w-full bg-[#0a0a0b] border border-white/10 rounded-xl pl-11 pr-5 py-4 text-white focus:border-[#135bec] outline-none transition-all font-bold",value:o.credits,onChange:t=>y({...o,credits:Number(t.target.value)})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-[2px] text-slate-500 mb-2 block",children:"Inicio"}),e.jsx("input",{type:"date",className:"w-full bg-[#0a0a0b] border border-white/10 rounded-xl px-5 py-4 text-white focus:border-[#135bec] outline-none transition-all text-xs",value:o.start_date,onChange:t=>y({...o,start_date:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-[2px] text-slate-500 mb-2 block",children:"Finalización"}),e.jsx("input",{type:"date",className:"w-full bg-[#0a0a0b] border border-white/10 rounded-xl px-5 py-4 text-white focus:border-[#135bec] outline-none transition-all text-xs",value:o.end_date,onChange:t=>y({...o,end_date:t.target.value})})]})]})]}),e.jsxs("div",{className:"bg-[#135bec]/5 border border-[#135bec]/20 rounded-xl p-4 flex items-start gap-4",children:[e.jsx("div",{className:"p-2 bg-[#135bec] rounded-lg text-white",children:e.jsx($,{className:"size-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-white uppercase tracking-widest",children:"Verificación de Balance"}),e.jsxs("p",{className:"text-[11px] text-slate-400 mt-1",children:["Se deducirán ",o.credits," créditos de tu balance mayorista (",L," disponibles)."]})]})]}),e.jsx("button",{type:"submit",disabled:w,className:"w-full py-5 bg-[#135bec] hover:bg-[#135bec]/90 text-white font-black rounded-2xl shadow-2xl shadow-[#135bec]/30 transition-all uppercase tracking-[3px] text-xs",children:w?"Sincronizando...":"Activar Instancia de Evento"})]})]})})]})},T=({IDENTITIES:k,onBack:j,initialView:r="dashboard"})=>{const[v,w]=i.useState(r),[g,c]=i.useState([]),[_,d]=i.useState([]),[N,x]=i.useState(!0),[p,u]=i.useState(""),[b,n]=i.useState(!1),[s,o]=i.useState({email:"",full_name:"",role:"client",is_master:!1}),[y,z]=i.useState({totalUsers:0,totalCredits:0,activeEvents:0});i.useEffect(()=>{S()},[]);const S=async()=>{var a,t;try{x(!0);const[l,f]=await Promise.all([m.from("profiles").select("*, partner:partners(*)").order("created_at",{ascending:!1}),m.from("partners").select("*").order("name",{ascending:!0})]);if(l.error)throw l.error;c(l.data||[]),d(f.data||[]);const C=((a=f.data)==null?void 0:a.reduce((E,Y)=>E+(Y.credits_total||0),0))||0;z({totalUsers:((t=l.data)==null?void 0:t.length)||0,totalCredits:C,activeEvents:12})}catch(l){console.error("Error fetching admin data:",l)}finally{x(!1)}},A=async(a,t)=>{if(a)try{const l=_.find(E=>E.id===a);if(!l)return;const f=(l.credits_total||0)+t,{error:C}=await m.from("partners").update({credits_total:f}).eq("id",a);if(C)throw C;S()}catch(l){console.error("Error updating credits:",l)}},D=async a=>{a.preventDefault();try{x(!0);const{data:t,error:l}=await m.from("profiles").insert([{email:s.email,full_name:s.full_name,role:s.role,is_master:s.is_master}]).select();if(l)throw l;if(s.role==="partner"){const{error:f}=await m.from("partners").insert([{name:s.full_name,user_id:t[0].id,credits_total:1e3,credits_used:0}]);if(f)throw f}n(!1),o({email:"",full_name:"",role:"client",is_master:!1}),S()}catch(t){console.error("Error adding user:",t),alert("Error adding user. Check console.")}finally{x(!1)}},U=async a=>{if(confirm("Are you sure you want to delete this user?"))try{const{error:t}=await m.from("profiles").delete().eq("id",a);if(t)throw t;S()}catch(t){console.error("Error deleting user:",t)}},P=g.filter(a=>{var t,l;return((t=a.full_name)==null?void 0:t.toLowerCase().includes(p.toLowerCase()))||((l=a.email)==null?void 0:l.toLowerCase().includes(p.toLowerCase()))}),L=_.filter(a=>{var t;return(t=a.name)==null?void 0:t.toLowerCase().includes(p.toLowerCase())});return e.jsxs("div",{className:"space-y-8 animate-fade-in text-slate-100",children:[e.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black tracking-tight text-white mb-1",children:"Eagle Eye Admin"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Global control center for user management & infrastructure."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex bg-[#135bec]/10 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>w("dashboard"),className:`px-4 py-1.5 rounded-md text-xs font-bold transition-all ${v==="dashboard"?"bg-[#135bec] text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:"Dashboard"}),e.jsx("button",{onClick:()=>w("partners"),className:`px-4 py-1.5 rounded-md text-xs font-bold transition-all ${v==="partners"?"bg-[#135bec] text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:"Partners"}),e.jsx("button",{onClick:()=>w("users"),className:`px-4 py-1.5 rounded-md text-xs font-bold transition-all ${v==="users"?"bg-[#135bec] text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:"Users List"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-5 py-2.5 bg-[#135bec] hover:bg-[#135bec]/90 rounded-lg text-sm font-bold text-white shadow-lg shadow-[#135bec]/25 transition-all",children:[e.jsx($e,{className:"w-4 h-4"}),"Add User"]})]})]}),v==="dashboard"&&e.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"glass-card rounded-xl p-6 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Total Users"}),e.jsx("h3",{className:"text-3xl font-black text-white",children:y.totalUsers})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs text-emerald-400 font-bold bg-emerald-500/10 self-start px-2 py-1 rounded",children:[e.jsx(oe,{className:"w-3 h-3"})," +5% this week"]})]}),e.jsxs("div",{className:"glass-card rounded-xl p-6 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Global Credits Distributed"}),e.jsx("h3",{className:"text-3xl font-black text-white",children:y.totalCredits.toLocaleString()})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs text-[#135bec] font-bold bg-[#135bec]/10 self-start px-2 py-1 rounded",children:[e.jsx(te,{className:"w-3 h-3"})," Active Balance"]})]}),e.jsxs("div",{className:"glass-card rounded-xl p-6 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase tracking-wider mb-1",children:"System Health"}),e.jsx("h3",{className:"text-3xl font-black text-white",children:"99.9%"})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs text-emerald-400 font-bold bg-emerald-500/10 self-start px-2 py-1 rounded",children:[e.jsx($,{className:"w-3 h-3"})," All Systems Operational"]})]})]}),v==="partners"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Registered Partners"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{type:"text",placeholder:"Search partners...",value:p,onChange:a=>u(a.target.value),className:"bg-slate-900/50 border-slate-800 rounded-lg pl-9 pr-4 py-1.5 text-xs text-white focus:ring-[#135bec] focus:border-[#135bec] w-64 transition-all outline-none"})]})]}),e.jsx("div",{className:"glass-card rounded-xl overflow-hidden",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-white/5 border-b border-white/10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Partner Name"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Credits (Used / Total)"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Load Credits"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:L.map(a=>{var t,l,f;return e.jsxs("tr",{className:"hover:bg-white/5 transition-colors group",children:[e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"size-9 rounded bg-[#135bec]/10 flex items-center justify-center text-[#135bec] font-bold text-xs",children:(t=a.name)==null?void 0:t.substring(0,2).toUpperCase()}),e.jsx("p",{className:"text-sm font-bold text-white",children:a.name})]})}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("span",{className:"text-sm font-mono text-white",children:[(l=a.credits_used)==null?void 0:l.toLocaleString()," / ",(f=a.credits_total)==null?void 0:f.toLocaleString()]}),e.jsx("div",{className:"w-32 h-1 bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-[#135bec]",style:{width:`${a.credits_used/a.credits_total*100}%`}})})]})}),e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>A(a.id,-500),className:"p-1 hover:bg-rose-500/20 rounded text-slate-400 hover:text-rose-500",children:e.jsx(we,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>A(a.id,500),className:"p-1 hover:bg-emerald-500/20 rounded text-slate-400 hover:text-emerald-500",children:e.jsx(K,{className:"w-4 h-4"})})]})}),e.jsx("td",{className:"px-6 py-5 text-right",children:e.jsx("button",{className:"px-3 py-1.5 bg-slate-800 hover:bg-slate-700 text-[10px] font-bold rounded text-white transition-all uppercase tracking-widest",children:"Manage"})})]},a.id)})})]})})]}),v==="users"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"All System Users"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{type:"text",placeholder:"Search users...",value:p,onChange:a=>u(a.target.value),className:"bg-slate-900/50 border-slate-800 rounded-lg pl-9 pr-4 py-1.5 text-xs text-white focus:ring-[#135bec] focus:border-[#135bec] w-64 transition-all outline-none"})]})]}),e.jsx("div",{className:"glass-card rounded-xl overflow-hidden",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-white/5 border-b border-white/10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest",children:"User"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Role"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Joined"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:P.map(a=>e.jsxs("tr",{className:"hover:bg-white/5 transition-colors group",children:[e.jsx("td",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:`https://api.dicebear.com/7.x/avataaars/svg?seed=${a.email}`,className:"size-9 rounded-full bg-slate-800",alt:"Avatar"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white",children:a.full_name}),e.jsx("p",{className:"text-[10px] text-slate-500",children:a.email})]})]})}),e.jsx("td",{className:"px-6 py-5",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${a.is_master?"bg-amber-500/20 text-amber-500":a.role==="partner"?"bg-[#135bec]/20 text-[#135bec]":"bg-slate-800 text-slate-400"}`,children:a.is_master?"Master":a.role})}),e.jsx("td",{className:"px-6 py-5 text-xs text-slate-400",children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-5 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-slate-700 rounded-lg text-slate-400 hover:text-white",children:e.jsx(_e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>U(a.id),className:"p-2 hover:bg-rose-500/20 rounded-lg text-slate-400 hover:text-rose-500",children:e.jsx(X,{className:"w-4 h-4"})})]})})]},a.id))})]})})]}),b&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"glass-card w-full max-w-md bg-slate-900 rounded-2xl border border-white/10 shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/5",children:[e.jsx("h3",{className:"text-xl font-black text-white",children:"ADD NEW USER"}),e.jsx("button",{onClick:()=>n(!1),className:"text-slate-500 hover:text-white",children:e.jsx(Q,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:D,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-[2px] text-slate-500 mb-2 block",children:"Full Name"}),e.jsx("input",{required:!0,type:"text",className:"w-full bg-background-dark border border-white/10 rounded-xl px-4 py-3 text-white focus:border-[#135bec] outline-none transition-all",value:s.full_name,onChange:a=>o({...s,full_name:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-[2px] text-slate-500 mb-2 block",children:"Email Address"}),e.jsx("input",{required:!0,type:"email",className:"w-full bg-background-dark border border-white/10 rounded-xl px-4 py-3 text-white focus:border-[#135bec] outline-none transition-all",value:s.email,onChange:a=>o({...s,email:a.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-[2px] text-slate-500 mb-2 block",children:"Role"}),e.jsxs("select",{className:"w-full bg-background-dark border border-white/10 rounded-xl px-4 py-3 text-white focus:border-[#135bec] outline-none transition-all",value:s.role,onChange:a=>o({...s,role:a.target.value}),children:[e.jsx("option",{value:"client",children:"Client"}),e.jsx("option",{value:"partner",children:"Partner"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-[2px] text-slate-500 mb-2 block",children:"Access Level"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer mt-2",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox bg-slate-800 border-white/10 text-[#135bec] rounded",checked:s.is_master,onChange:a=>o({...s,is_master:a.target.checked})}),e.jsx("span",{className:"text-xs text-white",children:"Master Admin"})]})]})]}),e.jsx("button",{type:"submit",disabled:N,className:"w-full py-4 bg-[#135bec] hover:bg-[#135bec]/90 text-white font-black rounded-xl shadow-xl shadow-[#135bec]/20 transition-all uppercase tracking-[2px] text-xs",children:N?"CREATING...":"CREATE USER ACCOUNT"})]})]})})]})},Ie=({user:k,profile:j})=>{const[r,v]=i.useState(null),[w,g]=i.useState(!0),[c,_]=i.useState(!1),[d,N]=i.useState({primary_color:"#135bec",welcome_text:"¡Bienvenidos a nuestro evento!",radius:"12px"}),[x,p]=i.useState([]);i.useEffect(()=>{u()},[j.email]);const u=async()=>{try{g(!0);const{data:s,error:o}=await m.from("events").select("*").eq("client_email",j.email).single();s&&(v(s),s.config&&N(s.config),s.selected_styles&&p(s.selected_styles))}catch(s){console.error("Error fetching event for client:",s)}finally{g(!1)}},b=async()=>{if(r)try{_(!0);const{error:s}=await m.from("events").update({config:d,selected_styles:x}).eq("id",r.id);if(s)throw s;alert("¡Configuración guardada con éxito!")}catch(s){console.error("Error saving event config:",s),alert("Error al guardar la configuración.")}finally{_(!1)}},n=s=>{p(o=>o.includes(s)?o.filter(y=>y!==s):[...o,s])};return w?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] text-white gap-4",children:[e.jsx("div",{className:"size-10 border-2 border-t-[#135bec] border-slate-800 rounded-full animate-spin"}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest opacity-50",children:"Cargando tu evento..."})]}):r?e.jsxs("div",{className:"space-y-8 animate-fade-in pb-20",children:[e.jsxs("header",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 border-b border-white/5 pb-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"px-2 py-0.5 bg-emerald-500/10 text-emerald-500 text-[9px] font-black uppercase tracking-widest rounded border border-emerald-500/20",children:"Evento Activo"}),e.jsxs("span",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-widest",children:["ID: #",r.id.substring(0,8)]})]}),e.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter uppercase mb-2",children:r.event_name}),e.jsx("p",{className:"text-slate-400 text-sm max-w-xl",children:"Bienvenido a tu panel de control. Aquí puedes personalizar cómo verán la experiencia tus invitados y gestionar el contenido generado."})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:()=>window.open(`https://photobooth.creativa-labs.com/?event=${r.event_slug}`,"_blank"),className:"flex items-center gap-2 px-6 py-3 bg-white text-slate-900 rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-slate-100 transition-all shadow-xl shadow-white/5",children:[e.jsx(me,{className:"size-4"}),"Ver Experiencia"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs("section",{className:"glass-card rounded-2xl p-8 border border-white/5 space-y-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"size-6 text-[#135bec]"}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tight",children:"Identidad Visual"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[2px] block mb-3",children:"Color de Acento"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"size-12 rounded-xl border-2 border-white/10 shadow-2xl cursor-pointer hover:scale-110 transition-transform",style:{backgroundColor:d.primary_color},onClick:()=>{var s;return(s=document.getElementById("clientColorPicker"))==null?void 0:s.click()}}),e.jsx("input",{id:"clientColorPicker",type:"color",className:"sr-only",value:d.primary_color,onChange:s=>N({...d,primary_color:s.target.value})}),e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",className:"w-full bg-slate-900/50 border border-slate-800 rounded-xl px-4 py-3 text-white font-mono text-sm focus:border-[#135bec] outline-none",value:d.primary_color,onChange:s=>N({...d,primary_color:s.target.value})})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[2px] block mb-3",children:"Texto de Bienvenida"}),e.jsx("textarea",{className:"w-full bg-slate-900/50 border border-slate-800 rounded-xl px-4 py-3 text-white text-sm focus:border-[#135bec] outline-none min-h-[100px] resize-none",placeholder:"Ej: ¡Bienvenidos a la boda de Javi y Sofi! Hazte una foto increíble...",value:d.welcome_text,onChange:s=>N({...d,welcome_text:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[2px] block mb-3",children:"Redondeo de Interfaz (Radius)"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["0px","8px","16px","32px"].map(s=>e.jsx("button",{onClick:()=>N({...d,radius:s}),className:`py-3 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${d.radius===s?"bg-[#135bec] text-white shadow-lg":"bg-slate-800 text-slate-500 hover:text-white"}`,children:s==="0px"?"Cuadrado":s==="32px"?"Redondo":s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[2px] block mb-3",children:"Logo del Evento"}),e.jsxs("div",{className:"w-full h-32 border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center bg-slate-900/40 hover:bg-slate-900 transition-all cursor-pointer group hover:border-[#135bec]/40",children:[e.jsx(fe,{className:"size-8 text-slate-700 group-hover:text-[#135bec] mb-2 transition-colors"}),e.jsx("p",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest",children:"Subir Identidad"})]})]})]})]}),e.jsx("div",{className:"pt-4 flex justify-end",children:e.jsxs("button",{onClick:b,disabled:c,className:"flex items-center gap-2 px-10 py-4 bg-[#135bec] hover:bg-[#135bec]/90 text-white font-black text-xs uppercase tracking-[3px] rounded-2xl transition-all shadow-2xl shadow-[#135bec]/30 disabled:opacity-50",children:[e.jsx(Ee,{className:"size-4"}),c?"Gurdando...":"Guardar Configuración"]})})]}),e.jsxs("section",{className:"glass-card rounded-2xl p-8 border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{className:"size-6 text-[#135bec]"}),e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tight",children:"Estilos Disponibles"})]}),e.jsxs("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:[x.length," Habilitados"]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:J.map(s=>e.jsxs("button",{onClick:()=>n(s),className:`relative group h-28 rounded-2xl overflow-hidden border-2 transition-all ${x.includes(s)?"border-[#135bec] scale-[1.05] shadow-xl shadow-[#135bec]/20":"border-white/5 opacity-40 hover:opacity-100"}`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 to-transparent z-10"}),e.jsx("img",{src:`https://api.dicebear.com/7.x/identicon/svg?seed=${s}`,className:"size-full object-cover group-hover:scale-110 transition-transform duration-700",alt:s}),e.jsx("span",{className:"absolute bottom-3 left-3 z-20 text-[9px] font-black uppercase text-white tracking-widest leading-none",children:s}),x.includes(s)&&e.jsx("div",{className:"absolute top-3 right-3 z-20 bg-[#135bec] rounded-full p-1 animate-in zoom-in",children:e.jsx($,{className:"size-3 text-white"})})]},s))})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"glass-card rounded-2xl p-8 border border-[#135bec]/20 bg-[#135bec]/5 text-center flex flex-col items-center",children:[e.jsx("div",{className:"size-16 bg-[#135bec] rounded-2xl flex items-center justify-center mb-6 shadow-xl shadow-[#135bec]/30",children:e.jsx(ae,{className:"size-10 text-white"})}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tight mb-2",children:"QR del Evento"}),e.jsx("p",{className:"text-slate-400 text-xs mb-8",children:"Tus invitados pueden escanear este código para entrar directamente a la experiencia."}),e.jsx("div",{className:"bg-white p-4 rounded-3xl shadow-2xl mb-8 group cursor-pointer hover:scale-105 transition-transform duration-500",children:e.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=https://photobooth.creativa-labs.com/?event=${r.event_slug}&color=030712&bgcolor=ffffff`,className:"size-48",alt:"QR Code"})}),e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsxs("button",{className:"flex items-center justify-center gap-2 w-full py-4 bg-white text-slate-900 font-black text-[10px] uppercase tracking-widest rounded-2xl hover:bg-slate-100 transition-all",children:[e.jsx(W,{className:"size-4"}),"Descargar para Impresión"]}),e.jsxs("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest mt-2",children:[r.credits_used," / ",r.credits_allocated," Créditos Usados"]})]})]}),e.jsxs("div",{className:"glass-card rounded-2xl p-8 border border-white/5 space-y-6",children:[e.jsxs("h3",{className:"text-lg font-black text-white uppercase tracking-tight flex items-center gap-2",children:[e.jsx(Z,{className:"size-5 text-slate-500"}),"Resumen"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-white/5",children:[e.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Slug de URL"}),e.jsxs("span",{className:"text-xs font-mono text-[#135bec]",children:["/",r.event_slug]})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-white/5",children:[e.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Expiración"}),e.jsx("span",{className:"text-xs text-white uppercase font-bold",children:new Date(r.end_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between items-center py-3",children:[e.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Soporte"}),e.jsx("span",{className:"text-xs text-white uppercase font-bold",children:"VIP Activo"})]})]})]})]})]})]}):e.jsxs("div",{className:"glass-card rounded-2xl p-12 text-center max-w-2xl mx-auto border border-white/5",children:[e.jsx(M,{className:"size-16 text-slate-800 mx-auto mb-6 opacity-30"}),e.jsx("h2",{className:"text-2xl font-black text-white mb-2 uppercase tracking-tight",children:"No se encontró tu evento"}),e.jsxs("p",{className:"text-slate-400 text-sm mb-8",children:["Parece que aún no tienes un evento asignado a tu correo (",j.email,"). Por favor, contacta a tu proveedor."]}),e.jsx("button",{className:"px-8 py-3 bg-[#135bec] hover:bg-[#135bec]/90 text-white font-bold rounded-xl transition-all shadow-xl shadow-[#135bec]/20 uppercase text-xs tracking-widest",children:"Contactar Soporte"})]})},Te=()=>{const[k,j]=i.useState(null),[r,v]=i.useState(null),[w,g]=i.useState(!0),[c,_]=i.useState("overview");i.useEffect(()=>{m.auth.getSession().then(({data:{session:u}})=>{j(u),u?d(u.user.id):g(!1)});const{data:{subscription:p}}=m.auth.onAuthStateChange((u,b)=>{j(b),b?d(b.user.id):(v(null),g(!1))});return()=>p.unsubscribe()},[]);const d=async p=>{try{g(!0);const{data:u,error:b}=await m.from("profiles").select("*, partner:partners(*)").eq("id",p).single();if(b)throw b;v(u)}catch(u){console.error("Error fetching profile:",u)}finally{g(!1)}},N=async()=>{await m.auth.signOut(),window.location.href="/cabina/"};if(w)return e.jsx("div",{className:"min-h-screen bg-[#0f172a] flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 border-t-2 border-[#135bec] rounded-full animate-spin"}),e.jsx("p",{className:"text-slate-400 text-sm font-medium animate-pulse",children:"Initializing dashboard..."})]})});if(!k)return e.jsx(re,{onAuthSuccess:()=>window.location.reload()});const x=(p,u,b)=>{const n=c===p;return e.jsxs("button",{onClick:()=>_(p),className:`w-full flex items-center gap-3 px-6 py-3 transition-all group text-left ${n?"bg-[#135bec]/15 text-[#135bec] border-r-[3px] border-[#135bec]":"text-slate-400 hover:text-white hover:bg-slate-900 border-r-[3px] border-transparent"}`,children:[e.jsx(b,{className:`w-5 h-5 group-hover:scale-110 transition-transform ${n?"text-[#135bec]":""}`}),e.jsx("span",{className:"text-sm font-medium",children:u})]},p)};return e.jsxs("div",{className:"flex h-screen w-full bg-[#0f172a] text-slate-100 font-sans overflow-hidden dark",children:[e.jsxs("aside",{className:"w-64 flex-shrink-0 bg-slate-950 border-r border-slate-800 flex flex-col justify-between py-6",children:[e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"px-6 flex items-center gap-3",children:[e.jsx("div",{className:"size-10 rounded-lg bg-[#135bec] flex items-center justify-center shadow-lg shadow-[#135bec]/20",children:e.jsx(V,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold tracking-tight text-white uppercase",children:"PHOTO BOOTH"}),e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-slate-500 font-semibold",children:"Reseller Pro"})]})]}),e.jsxs("nav",{className:"flex flex-col gap-1",children:[x("overview","Dashboard",ve),(r==null?void 0:r.role)==="partner"&&e.jsxs(e.Fragment,{children:[x("events","Events",M),x("branding","White Label",B)]}),(r==null?void 0:r.role)==="client"&&e.jsxs(e.Fragment,{children:[x("overview","Mi Evento",M),x("gallery","Ver Galería",V)]}),(r==null?void 0:r.is_master)&&e.jsxs(e.Fragment,{children:[x("master","Partners",le),x("users","Users List",Ue)]}),e.jsxs("button",{className:"w-full flex items-center gap-3 px-6 py-3 text-slate-400 hover:text-white hover:bg-slate-900 transition-all group text-left border-r-[3px] border-transparent",children:[e.jsx(Z,{className:"w-5 h-5 group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-sm font-medium",children:"Settings"})]})]})]}),e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"p-4 rounded-xl bg-slate-900 border border-slate-800 flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:`https://api.dicebear.com/7.x/avataaars/svg?seed=${k.user.email}`,alt:"Profile",className:"size-10 rounded-full border-2 border-slate-700 bg-slate-800 object-cover"}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-xs font-bold text-white truncate",children:(r==null?void 0:r.full_name)||"Admin User"}),e.jsx("span",{className:"text-[10px] text-slate-500 uppercase tracking-wider",children:(r==null?void 0:r.role)==="partner"?"Partner Admin":r!=null&&r.is_master?"Master Admin":"Guest"})]})]}),e.jsx("button",{onClick:N,className:"w-full py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-[11px] font-bold text-white transition-colors uppercase tracking-wider",children:"LOGOUT"})]})})]}),e.jsx("main",{className:"flex-1 overflow-y-auto custom-scrollbar p-8 bg-[#0f172a]",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[c==="overview"&&e.jsx("div",{className:"animate-fade-in",children:r!=null&&r.is_master?e.jsx(T,{IDENTITIES:R,onBack:()=>{}}):(r==null?void 0:r.role)==="partner"?e.jsx(I,{user:k.user,profile:r,onBack:()=>{},initialView:"overview"}):(r==null?void 0:r.role)==="client"?e.jsx(Ie,{user:k.user,profile:r}):e.jsxs("div",{className:"text-center py-20",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Bienvenido"}),e.jsx("p",{className:"text-slate-400",children:"Panel de generación pública (Modelo A) próximamente..."})]})}),c==="events"&&e.jsx(I,{user:k.user,profile:r,onBack:()=>{},initialView:"events"}),c==="branding"&&e.jsx(I,{user:k.user,profile:r,onBack:()=>{},initialView:"branding"}),c==="master"&&e.jsx(T,{IDENTITIES:R,onBack:()=>{},initialView:"partners"}),c==="users"&&e.jsx(T,{IDENTITIES:R,onBack:()=>{},initialView:"users"})]})})]})},F=document.getElementById("dashboard-root");F&&ce.createRoot(F).render(e.jsx(ie.StrictMode,{children:e.jsx(Te,{})}));
